# EdgeOne Pages 全功能反向代理

这是一个基于腾讯云 EdgeOne Pages 部署的通用反向代理项目。它源于对 [Cloudflare-Workers-Proxy](https://github.com/ymyuuu/Cloudflare-Workers-Proxy) 项目的改造，使其能够完美运行在腾讯云的边缘网络上。

本项目允许您轻松部署一个无需服务器、自动扩缩容、全球加速的反向代理服务。您可以直接访问部署后的域名，在前端页面中输入目标网址进行代理，也可以通过 `域名/目标网址` 的格式直接访问。

## ✨ 功能特性

- **通用反向代理**：能够代理访问互联网上几乎任何网站。
- **无服务器化部署**：基于 EdgeOne Pages 边缘函数，无需购买和管理服务器。
- **边缘节点加速**：所有请求均由离用户最近的腾讯云边缘节点处理，延迟更低。
- **动态路径重写**：自动重写 HTML 中的相对路径资源（如 CSS, JS, 图片），确保页面正常加载。
- **重定向跟随**：正确处理 301/302 等重定向请求，确保跳转后仍在代理体系内。
- **CORS 自动处理**：自动添加 CORS 头部，允许您将其作为 API 代理进行跨域调用。
- **简洁的用户界面**：提供一个美观、易用的前端页面，方便快速发起代理。

## 🚀 工作原理

本项目充分利用了 EdgeOne Pages **静态托管 + 边缘函数** 的混合模式：

1.  **静态首页 (`static/index.html`)**
    当您访问部署后的根域名 (`/`) 时，EdgeOne Pages 会优先提供 `static` 目录下的 `index.html` 文件。这是一个静态页面，包含了输入框和跳转逻辑。

2.  **边缘函数 (`functions/[[path]].js`)**
    当您通过首页跳转或直接访问一个非根路径（如 `/https://example.com`）时，EdgeOne Pages 在静态目录中找不到匹配的文件，此时请求会被 `functions` 目录下的**通配路由函数 `[[path]].js`** 捕获。这个函数是实现所有代理逻辑的核心，它会：
    - 解析路径中的目标 URL。
    - 向目标 URL 发起请求。
    - 处理响应（重写路径、修改重定向头等）。
    - 将最终结果返回给用户。

这种结构将用户界面和后端逻辑完全分离，清晰且高效。

## 部署指南 (通过 EdgeOne 网页控制台)

您无需在本地安装任何工具。只需一个 GitHub 账号和腾讯云账号即可完成所有操作。

### 前提条件

1.  拥有一个 [GitHub](https://github.com/) 账号。
2.  拥有一个已开通 [腾讯云 EdgeOne 服务](https://cloud.tencent.com/product/edgeone) 的腾讯云账号。

### 部署步骤

1.  **Fork 本项目**
    点击本仓库右上角的 **Fork** 按钮，将此项目复刻到您自己的 GitHub 账户下。

2.  **登录 EdgeOne 控制台**
    访问 [腾讯云 EdgeOne 控制台](https://console.cloud.tencent.com/edgeone)。

3.  **新建 Pages 站点**
    - 在左侧菜单中，选择 **站点服务** > **Pages**。
    - 点击 **新建站点** 按钮。

4.  **关联 GitHub 仓库**
    - 在部署方式中，选择 **关联 Git 仓库进行部署**。
    - 点击 **授权 Pages**，在弹出的窗口中授权腾讯云访问您的 GitHub 仓库。
    - 授权成功后，选择您刚刚 Fork 的仓库（`edgeone-proxy`）。

5.  **配置构建选项**
    这是最关键的一步，请严格按照以下配置填写：
    - **项目名称**：自定义，例如 `my-proxy`。
    - **生产分支**：选择 `main` 或者您仓库的默认分支。
    - **构建框架预设**：选择 **`其他`**。
    - **构建命令**：**`留空`** (非常重要！因为本项目无需构建)。
    - **根目录**：保持默认的 `/` 或留空。
    - **输出目录**：**`static`** (指向我们的静态文件目录)。
    - **环境变量**：无需填写。

6.  **保存并部署**
    - 点击 **保存并部署**。
    - EdgeOne Pages 会开始拉取您的代码并进行部署。由于没有构建步骤，这个过程通常在 1 分钟内完成。

7.  **访问您的代理**
    - 部署成功后，平台会自动生成一个 `.edgeonepage.com` 的免费域名。
    - 点击该域名，即可访问您的反向代理服务！

## 🔧 使用方法

部署成功后，您可以通过以下两种方式使用：

1.  **通过首页访问**
    - 直接访问您的域名，例如 `https://my-proxy-xxxx.edgeonepage.com`。
    - 在输入框中填入您想代理的目标网址（如 `https://www.google.com`），点击 **跳转**。

2.  **通过 URL 直接访问**
    - 在您的域名后直接拼接上要代理的 URL 即可。
    - 格式：`https://<您的域名>/<目标URL>`
    - 示例：`https://my-proxy-xxxx.edgeonepage.com/https://www.typescriptlang.org/`

## ⚠️ 免责声明

- 本项目仅供学习和研究使用，作者不对任何因使用本项目而导致的任何问题负责，包括但不限于数据丢失、服务中断、法律纠纷等。
- 使用者需了解，本项目可能被用于访问受限内容或进行未经授权的活动。作者强烈反对任何不当使用行为，并鼓励使用者在合法合规的前提下使用。
- 请确保您拥有对所代理的目标地址的合法访问权限。
- 任何使用者在使用本项目时，需自行承担全部风险。作者和腾讯云不对任何滥用、不当使用或由此导致的任何损害承担责任。

## 📁 项目结构

```
.
├── functions/
│   └── [[path]].js   # 核心代理函数，捕获所有非静态文件请求
├── static/
│   └── index.html    # 静态首页，匹配 "/" 路径
├── LICENSE           # MIT 许可证文件
└── README.md         # 本说明文件
```

## 📄 许可证

本项目采用 [MIT License](./LICENSE)。

## 🙏 致谢

- 本项目基于 [Cloudflare-Workers-Proxy](https://github.com/ymyuuu/Cloudflare-Workers-Proxy) 的优秀设计。
